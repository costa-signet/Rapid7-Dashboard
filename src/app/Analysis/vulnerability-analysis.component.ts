import { Component } from '@angular/core';
import { catchError, EMPTY } from 'rxjs';
import { AppService } from '../app.service';
import { AssetAnalysis, IPAnalysis, MACAnalysis } from '../Types/Asset-Analysis';

const ASSET_DATA: AssetAnalysis[] = [
  {"Asset Name": "MIS-3084-WEB2","Count": 186},
  {"Asset Name": "MIS-3084-WEB4.jewels.local","Count": 137},
  {"Asset Name": "PWSAPJADM01","Count": 246},
  {"Asset Name": "PWSAPJADM02","Count": 9},
  {"Asset Name": "QWCOPIMAPP01.jewels.com","Count": 111},
  {"Asset Name": "wvwebboead","Count": 268},
  {"Asset Name": "xcscrlems01.cloudcore.local","Count": 301},
  {"Asset Name": "xlmuleapp01","Count": 186},
  {"Asset Name": "xlmuleapp02","Count": 186},
  {"Asset Name": "xlmuleapp04","Count": 269}];

const IP_DATA: IPAnalysis[] =[
  {"IP Address": "10.22.100.38","Count": 310},
  {"IP Address": "10.224.0.100","Count": 116},
  {"IP Address": "10.224.0.107","Count": 116},
  {"IP Address": "10.224.0.108","Count": 116},
  {"IP Address": "10.224.0.11","Count": 259},
  {"IP Address": "172.29.210.29","Count": 269},
  {"IP Address": "172.29.210.30","Count": 269},
  {"IP Address": "172.29.210.31","Count": 168},
  {"IP Address": "172.29.210.32","Count": 168},
  {"IP Address": "172.29.211.60","Count": 750}]

const MAC_DATA: MACAnalysis[] = [
  {"MAC Address": "000C2945FE17","Count": 301},
  {"MAC Address": "000D3A6095B2","Count": 186},
  {"MAC Address": "000D3A6096F2","Count": 269},
  {"MAC Address": "000D3A61CB8A","Count": 186},
  {"MAC Address": "0010E040E83A","Count": 237},
  {"MAC Address": "E4434B3C0ECC","Count": 326},
  {"MAC Address": "E4434B3C0ED8","Count": 326},
  {"MAC Address": "E4434B3C0EDC", "Count": 259},
  {"MAC Address": "E4434B3D7B28", "Count": 443},
  {"MAC Address": "E4434B3D7CC8", "Count": 120}]

@Component({
  selector: 'app-vulnerability-analysis',
  templateUrl: './vulnerability-analysis.component.html',
  styleUrls: ['./vulnerability-analysis.component.css']
})
export class VulAnalysisComponent{ 
  dataSource3 = MAC_DATA;
  dataSource2 = IP_DATA;
  dataSource = ASSET_DATA;
  errorMessage: string = ''
  displayedColumns: string[] = ['Asset Name', 'Count'];
  displayedColumns2: string[] = ['IP Address', 'Count'];
  displayedColumns3: string[] = ['MAC Address', 'Count'];
  constructor (private appService: AppService){}

  //selectedRapid7: string = '2023-05-02-rapid7.csv'
  asset$ = this.appService.asset$
    .pipe(
      catchError(err => {
        this.errorMessage = err;
        return EMPTY;
      })
    );

  ip$ = this.appService.ip$
    .pipe(
      catchError(err => {
        this.errorMessage = err;
        return EMPTY;
      })
    );
  mac$ = this.appService.mac$
    .pipe(
      catchError(err => {
        this.errorMessage = err;
        return EMPTY;
      })
    );
}
